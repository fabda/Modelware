# Download models from various repository

# Get Variables from Modelware configuration file
. $MW_HOME/conf/mw.conf

# Argument checker
if [ $# -eq 0 ]
  then
    echo "Nothing to do ? check help : mw --help "
    exit 1
fi


# Helper
if [ $1 = '-h' ] || [ $1 = '--help' ]
  then
  echo "Usage : `basename $0` fromgdrive [URL link]  : download a model from google drive URL"
  echo "   or : `basename $0` fromurl    [URL link]  : download a model from an URL (not google drive)"
  echo " "
  exit 0
fi


# From Google Drive (with two type of URLs possible)
if [ $1 = "fromgdrive" ]
  then
    echo "Downloading model from Google Drive URL : $2:"
    #Type 1 URL
    ID=`echo $2 | cut -d '/' -f 6`
    if [ -z "$ID" ]
      then
        #Type 2 URL
        ID=`echo "$2" | cut -d '=' -f 2`
    fi
    gdown -O model.zip https://drive.google.com/uc?id=$ID
    unzip -o model.zip -d $MW_HOME/models/
    rm -f model.zip
fi
